pipeline {
    agent any

    tools {
        maven 'mymaven'
     }

     stages {
         stage ('clone the repository')
         {
              steps {
                  git 'Github URL'
              }
          }

          stage ('test the code') {
              steps {
                   sh 'mvn test'
              }
          }

          stage ('Build the code'){
              steps {
                   sh 'mvn package'
              }
          }

          stage ('Build Image') {
               steps {
                   sh 'docker build -t bankingfinanceproject:${BUILD_NUMBER} .'
               }
           }

           stage ('Deploy the image'){
               steps {
                   sh 'docker run -d -P bankingfinanceproject:${BUILD_NUMBER} '
               }
           }

           stage ( 'push the image to dockerhub'){
               steps {
           withCredentials([string(Crendentialsid: 'DOCKER_HUB_PASWD', variable : 'DOCKER_HUB-PASWD')])
                   {
                   sh 'docker login -u srinath7019 -p ${DOCKER_HUB_PASWD}'
                   }
                    sh 'docker tag bankingfinanceproject:${BUILD_NUMBER} srinath7019/bankingfinanceproject:$${BUILD_NUMBER}'
                    sh 'docker push srinath7019/bankingfinanceproject:${BUILD_NUMBER}'
               }
          }
     }
 }
                   
                
             
